import{a as O,b as k,c as E,d as F,e as D,f as M,i as T,j as _}from"./chunk-KEBMNPML.js";import{o as a,p as N,q}from"./chunk-M2RA2J4T.js";import{Bb as j,J as C,Ka as L,M as w,O as y,S as s,W as I,X as i,gb as S,ia as x,j as A,m,ma as R,n as l,q as n,z as U}from"./chunk-BA6MHJFO.js";var u={production:!0,auth:{mode:"remote",base:"https://auth.neosaisolutions.com/auth"}};var c={production:!0,auth:{mode:"remote",base:"https://auth.neosaisolutions.com/auth"}};var $=!u.production&&u.auth.mode==="mock",p=class e{constructor(t){this.http=t;this.ensureSession().subscribe()}_user$=new A(null);user$=this._user$.asObservable();hydrated$;mapApiUser(t){return{username:t?.username??t?.user??"",nombre:t?.nombre,apellido:t?.apellido,email:t?.email}}ensureSession(){if(this._user$.value)return m(!0);if(this.hydrated$)return this.hydrated$;if($){let o=localStorage.getItem("mockUser");if(o)return this._user$.next(JSON.parse(o)),this.hydrated$=m(!0).pipe(C(1)),this.hydrated$}let t=c.auth.base;return this.hydrated$=this.http.get(`${t}/current-user`,{withCredentials:!0}).pipe(n(o=>this.mapApiUser(o)),y(o=>this._user$.next(o)),n(()=>!0),U(()=>(this._user$.next(null),m(!1))),C(1)),this.hydrated$}login(t){if($){let r=u.auth.mockCreds;if(t.username===r.username&&t.password===r.password){let b=u.auth.mockUser;return this._user$.next(b),localStorage.setItem("mockUser",JSON.stringify(b)),m(b)}return l(()=>new Error("Credenciales inv\xE1lidas"))}let o=c.auth.base;return this.http.post(`${o}/login`,t,{withCredentials:!0}).pipe(w(()=>this.http.get(`${o}/current-user`,{withCredentials:!0})),n(r=>this.mapApiUser(r)),y(r=>this._user$.next(r)))}logout(){if(this.hydrated$=void 0,$){this._user$.next(null),localStorage.removeItem("mockUser");return}let t=c.auth.base;this.http.post(`${t}/logout`,{},{withCredentials:!0}).subscribe({complete:()=>this._user$.next(null),error:()=>this._user$.next(null)})}isLoggedIn(){return!!this._user$.value}getSnapshot(){return this._user$.value}static \u0275fac=function(o){return new(o||e)(I(k))};static \u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"})};function J(e){return e.createUrlTree(["/login"])}var H=()=>{let e=i(p),t=i(M);return e.ensureSession().pipe(n(o=>o?!0:J(t)))};var B=[{path:"",pathMatch:"full",redirectTo:"welcome"},{path:"login",loadComponent:()=>import("./chunk-BUFQLZEG.js").then(e=>e.LoginComponent)},{path:"",canActivate:[H],loadComponent:()=>import("./chunk-55DCD5TK.js").then(e=>e.LayoutComponent),children:[{path:"welcome",loadComponent:()=>import("./chunk-H43GHMCT.js").then(e=>e.WelcomeComponent)},{path:"components",loadComponent:()=>import("./chunk-LFBTFTHH.js").then(e=>e.ComponentsComponent)},{path:"documentation",loadComponent:()=>import("./chunk-QTAQOWHK.js").then(e=>e.DocumentationComponent)},{path:"settings",loadComponent:()=>import("./chunk-35WQ5MYQ.js").then(e=>e.SettingsComponent)}]},{path:"**",redirectTo:"welcome"}];var d=class e extends a{authService=i(p);login(t){return this.authService.login(t).pipe(n(o=>({username:o.username,nombre:o.nombre??"",apellido:o.apellido??"",email:o.email??""})))}logout(){return this.authService.logout()}getUser$(){return this.authService.user$.pipe(n(t=>t?{username:t.username,nombre:t.nombre??"",apellido:t.apellido??"",email:t.email??""}:null))}static \u0275fac=(()=>{let t;return function(r){return(t||(t=R(e)))(r||e)}})();static \u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"})};var f=class e{authRepository=i(a);execute(t){return!t.username||!t.password?l(()=>new Error("Usuario y contrasenia son obligatorias")):this.authRepository.login(t)}static \u0275fac=function(o){return new(o||e)};static \u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"})};var v=class e{authRepository=i(a);execute(){return this.authRepository.logout()}static \u0275fac=function(o){return new(o||e)};static \u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"})};var G={providers:[j({eventCoalescing:!0}),E(F()),{provide:a,useClass:d},{provide:N,useClass:f},{provide:q,useClass:v},T(B,_())]};var g=class e{title=x("neos-template");static \u0275fac=function(o){return new(o||e)};static \u0275cmp=L({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(o,r){o&1&&S(0,"router-outlet")},dependencies:[D],encapsulation:2})};O(g,G).catch(e=>console.error(e));
